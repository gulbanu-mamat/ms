# æ•°æ®åº“ä½¿ç”¨æƒ…å†µåˆ†ææŠ¥å‘Š

## ğŸ“Š å½“å‰æ•°æ®å­˜å‚¨çŠ¶æ€

### ğŸ—„ï¸ SQLiteæ•°æ®åº“ (warehouse_system.db)
**æ•°æ®åº“å¤§å°**: 40KB  
**çŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œï¼ŒåŒ…å«å®Œæ•´æ•°æ®

| è¡¨å | è®°å½•æ•° | çŠ¶æ€ | è¯´æ˜ |
|------|--------|------|------|
| warehouses | 15æ¡ | âœ… å……è¶³ | ä»“åº“æ•°æ®ï¼Œæ”¯æŒæ»šåŠ¨æµ‹è¯• |
| goods | 18æ¡ | âœ… å……è¶³ | è´§ç‰©æ•°æ®ï¼Œæ”¯æŒç¿»é¡µåŠŸèƒ½ |
| vehicles | 16æ¡ | âœ… å……è¶³ | è½¦è¾†æ•°æ®ï¼Œæ”¯æŒæ»šåŠ¨æµè§ˆ |
| orders | 18æ¡ | âœ… å……è¶³ | è®¢å•æ•°æ®ï¼Œæ”¯æŒåˆ†é¡µæ˜¾ç¤º |

### ğŸ“ ä¼ ç»Ÿæ•°æ®æ–‡ä»¶ (.datæ ¼å¼)
**å­˜å‚¨æ–¹å¼**: äºŒè¿›åˆ¶æ–‡ä»¶  
**çŠ¶æ€**: âš ï¸ ä¸SQLiteæ•°æ®å¯èƒ½ä¸åŒæ­¥

| æ–‡ä»¶å | å¤§å° | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|------|
| warehouses.dat | 484B | âš ï¸ æ—§æ•°æ® | å¯èƒ½åŒ…å«5æ¡è®°å½• |
| goods.dat | 964B | âš ï¸ æ—§æ•°æ® | å¯èƒ½åŒ…å«7æ¡è®°å½• |
| vehicles.dat | 388B | âš ï¸ æ—§æ•°æ® | å¯èƒ½åŒ…å«4æ¡è®°å½• |
| orders.dat | 2.2KB | âš ï¸ æ—§æ•°æ® | æ•°æ®é‡æœªçŸ¥ |

---

## ğŸ”„ æ•°æ®åº“è¿ç”¨æ–¹å¼åˆ†æ

### 1. åŒé‡å­˜å‚¨ç³»ç»Ÿ
ä½ çš„ç¨‹åºç›®å‰é‡‡ç”¨**åŒé‡å­˜å‚¨ç³»ç»Ÿ**ï¼š

```
ç”¨æˆ·æ“ä½œ â†’ å†…å­˜æ•°ç»„ â†’ åŒæ—¶ä¿å­˜åˆ°:
                    â”œâ”€â”€ ä¼ ç»Ÿ.datæ–‡ä»¶ (äºŒè¿›åˆ¶)
                    â””â”€â”€ SQLiteæ•°æ®åº“ (SQL)
```

### 2. æ•°æ®åº“çš„å®é™…è¿ç”¨

#### âœ… **æ­£åœ¨ä½¿ç”¨çš„åŠŸèƒ½**:
- **Database Viewer**: é€šè¿‡SQLiteæŸ¥çœ‹æ•°æ®
- **æ•°æ®æŒä¹…åŒ–**: æ–°å¢æ•°æ®è‡ªåŠ¨ä¿å­˜åˆ°æ•°æ®åº“
- **åˆ†é¡µæŸ¥è¯¢**: ä½¿ç”¨SQLçš„LIMITå’ŒOFFSET
- **æ•°æ®ç»Ÿè®¡**: é€šè¿‡SQL COUNTæŸ¥è¯¢

#### ğŸ“‹ **å…·ä½“ä½¿ç”¨åœºæ™¯**:
```c
// 1. ç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ–æ•°æ®åº“
initDatabase(&g_database);

// 2. æ·»åŠ æ•°æ®æ—¶åŒæ—¶ä¿å­˜
addWarehouse() â†’ saveToFile() + saveToDatabase()

// 3. Database VieweræŸ¥çœ‹æ•°æ®
SELECT * FROM warehouses LIMIT 10 OFFSET 0;

// 4. ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤º
SELECT COUNT(*) FROM warehouses;
```

---

## ğŸ“ˆ æ•°æ®æ–‡ä»¶æ•´ç†çŠ¶å†µ

### ğŸ¯ **æ•´ç†å®Œæˆåº¦**: 85%

#### âœ… **å·²å®Œæˆçš„æ•´ç†**:
1. **SQLiteæ•°æ®åº“ç»“æ„**:
   ```sql
   -- æ ‡å‡†åŒ–çš„è¡¨ç»“æ„
   CREATE TABLE warehouses (
       id INTEGER PRIMARY KEY AUTOINCREMENT,
       name TEXT NOT NULL,
       location TEXT,
       capacity INTEGER,
       created_at DATETIME DEFAULT CURRENT_TIMESTAMP
   );
   ```

2. **æ•°æ®åŒæ­¥æœºåˆ¶**:
   - æ–°å¢æ•°æ®è‡ªåŠ¨ä¿å­˜åˆ°æ•°æ®åº“
   - Database Viewerå®æ—¶æ˜¾ç¤ºæœ€æ–°æ•°æ®
   - æµ‹è¯•æ•°æ®æ‰¹é‡å¯¼å…¥å®Œæˆ

3. **æ–‡ä»¶ç»„ç»‡ç»“æ„**:
   ```
   program3/
   â”œâ”€â”€ warehouse_system.db     # ä¸»æ•°æ®åº“ (40KB)
   â”œâ”€â”€ *.dat                   # ä¼ ç»Ÿæ–‡ä»¶ (å…¼å®¹æ€§)
   â”œâ”€â”€ database_menu.*         # æ•°æ®åº“ç•Œé¢
   â”œâ”€â”€ sqlite_db.*             # æ•°æ®åº“æ“ä½œ
   â””â”€â”€ æ•°æ®åº“ç›¸å…³æ–‡æ¡£.md       # æŠ€æœ¯æ–‡æ¡£
   ```

#### âš ï¸ **éœ€è¦æ”¹è¿›çš„åœ°æ–¹**:

1. **æ•°æ®åŒæ­¥é—®é¢˜**:
   ```
   é—®é¢˜: .datæ–‡ä»¶ä¸SQLiteæ•°æ®ä¸ä¸€è‡´
   åŸå› : æµ‹è¯•æ•°æ®åªæ·»åŠ åˆ°äº†æ•°æ®åº“ï¼Œæœªæ›´æ–°.datæ–‡ä»¶
   å½±å“: ç¨‹åºé‡å¯æ—¶å¯èƒ½æ•°æ®ä¸ä¸€è‡´
   ```

2. **æ•°æ®æ¥æºæ··ä¹±**:
   ```
   å½“å‰çŠ¶æ€:
   - ç¨‹åºå¯åŠ¨ â†’ ä».datæ–‡ä»¶åŠ è½½åˆ°å†…å­˜
   - Database Viewer â†’ ä»SQLiteè¯»å–
   - æ–°å¢æ•°æ® â†’ åŒæ—¶ä¿å­˜åˆ°ä¸¤å¤„
   
   é—®é¢˜: åˆå§‹æ•°æ®æ¥æºä¸ç»Ÿä¸€
   ```

---

## ğŸ”§ æ•°æ®åº“è¿ç”¨å»ºè®®

### 1. ç»Ÿä¸€æ•°æ®æºç­–ç•¥

#### æ–¹æ¡ˆA: SQLiteä¸ºä¸» (æ¨è)
```c
// ç¨‹åºå¯åŠ¨æ—¶ä»æ•°æ®åº“åŠ è½½
void loadDataFromDatabase() {
    // æ¸…ç©ºå†…å­˜æ•°ç»„
    warehouseCount = 0;
    
    // ä»SQLiteåŠ è½½åˆ°å†…å­˜
    sqlite3_stmt* stmt;
    sqlite3_prepare_v2(db, "SELECT * FROM warehouses", -1, &stmt, NULL);
    
    while (sqlite3_step(stmt) == SQLITE_ROW) {
        // å¡«å……å†…å­˜æ•°ç»„
        warehouses[warehouseCount++] = parseFromDatabase(stmt);
    }
}
```

#### æ–¹æ¡ˆB: åŒå‘åŒæ­¥
```c
// å¯åŠ¨æ—¶åŒæ­¥æ•°æ®
void syncDataSources() {
    int dbCount = getDatabaseRecordCount();
    int fileCount = getFileRecordCount();
    
    if (dbCount > fileCount) {
        // æ•°æ®åº“æ›´æ–°ï¼ŒåŒæ­¥åˆ°æ–‡ä»¶
        exportDatabaseToFiles();
    } else if (fileCount > dbCount) {
        // æ–‡ä»¶æ›´æ–°ï¼ŒåŒæ­¥åˆ°æ•°æ®åº“
        importFilesToDatabase();
    }
}
```

### 2. æ•°æ®ç®¡ç†ä¼˜åŒ–

#### å®æ—¶åŒæ­¥æœºåˆ¶
```c
// ç»Ÿä¸€çš„æ•°æ®ä¿å­˜å‡½æ•°
int saveWarehouse(Warehouse* warehouse) {
    // 1. ä¿å­˜åˆ°å†…å­˜
    warehouses[warehouseCount++] = *warehouse;
    
    // 2. ä¿å­˜åˆ°æ–‡ä»¶
    int fileResult = saveWarehousesToFile();
    
    // 3. ä¿å­˜åˆ°æ•°æ®åº“
    int dbResult = saveWarehouseToDatabase(warehouse);
    
    // 4. æ£€æŸ¥ä¸€è‡´æ€§
    if (fileResult && dbResult) {
        return SUCCESS;
    } else {
        // å›æ»šæ“ä½œ
        rollbackWarehouse();
        return ERROR;
    }
}
```

---

## ğŸ“‹ æ•°æ®æ•´ç†è¡ŒåŠ¨è®¡åˆ’

### é˜¶æ®µ1: æ•°æ®ä¸€è‡´æ€§ä¿®å¤ (ç«‹å³æ‰§è¡Œ)

1. **æ£€æŸ¥æ•°æ®å·®å¼‚**:
   ```bash
   # æ¯”è¾ƒæ•°æ®åº“å’Œæ–‡ä»¶è®°å½•æ•°
   sqlite3 warehouse_system.db "SELECT COUNT(*) FROM warehouses;"
   # æ£€æŸ¥.datæ–‡ä»¶è®°å½•æ•° (é€šè¿‡ç¨‹åº)
   ```

2. **æ•°æ®åŒæ­¥**:
   ```c
   // åˆ›å»ºæ•°æ®åŒæ­¥å·¥å…·
   void syncAllData() {
       exportDatabaseToFiles();  // æ•°æ®åº“ â†’ æ–‡ä»¶
       printf("æ•°æ®åŒæ­¥å®Œæˆ\n");
   }
   ```

### é˜¶æ®µ2: ä¼˜åŒ–æ•°æ®ç®¡ç† (çŸ­æœŸç›®æ ‡)

1. **ç»Ÿä¸€æ•°æ®åŠ è½½**:
   - ä¿®æ”¹ç¨‹åºå¯åŠ¨é€»è¾‘
   - ä¼˜å…ˆä»SQLiteåŠ è½½æ•°æ®
   - .datæ–‡ä»¶ä½œä¸ºå¤‡ä»½

2. **æ·»åŠ æ•°æ®éªŒè¯**:
   ```c
   // æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥
   bool validateDataConsistency() {
       return (getDatabaseCount() == getMemoryCount() && 
               getMemoryCount() == getFileCount());
   }
   ```

### é˜¶æ®µ3: é«˜çº§åŠŸèƒ½æ‰©å±• (é•¿æœŸç›®æ ‡)

1. **æ•°æ®å¯¼å…¥å¯¼å‡º**:
   - CSVæ ¼å¼å¯¼å‡º
   - Excelæ ¼å¼æ”¯æŒ
   - æ•°æ®å¤‡ä»½æ¢å¤

2. **æ•°æ®åˆ†æåŠŸèƒ½**:
   - ç»Ÿè®¡æŠ¥è¡¨ç”Ÿæˆ
   - æ•°æ®è¶‹åŠ¿åˆ†æ
   - è‡ªåŠ¨åŒ–æŠ¥å‘Š

---

## ğŸ¯ æ€»ç»“ä¸å»ºè®®

### âœ… **ä½ å·²ç»æˆåŠŸå®ç°**:
1. SQLiteæ•°æ®åº“å®Œå…¨é›†æˆ
2. Database Vieweræ»šåŠ¨åŠŸèƒ½æ­£å¸¸
3. å……è¶³çš„æµ‹è¯•æ•°æ® (67æ¡è®°å½•)
4. åŒé‡å­˜å‚¨ç³»ç»Ÿè¿è¡Œ

### ğŸ”§ **éœ€è¦ç«‹å³å¤„ç†**:
1. **æ•°æ®åŒæ­¥é—®é¢˜**: .datæ–‡ä»¶ä¸æ•°æ®åº“ä¸ä¸€è‡´
2. **å¯åŠ¨é€»è¾‘**: ç»Ÿä¸€æ•°æ®åŠ è½½æº
3. **ä¸€è‡´æ€§æ£€æŸ¥**: æ·»åŠ æ•°æ®éªŒè¯æœºåˆ¶

### ğŸš€ **æ¨èçš„æ”¹è¿›æ–¹æ¡ˆ**:

```c
// å»ºè®®çš„ç¨‹åºå¯åŠ¨æµç¨‹
int main() {
    // 1. åˆå§‹åŒ–æ•°æ®åº“
    initDatabase(&g_database);
    
    // 2. æ£€æŸ¥æ•°æ®ä¸€è‡´æ€§
    if (!validateDataConsistency()) {
        // 3. æ•°æ®åŒæ­¥ (æ•°æ®åº“ä¸ºå‡†)
        syncDataFromDatabase();
    }
    
    // 4. åŠ è½½æ•°æ®åˆ°å†…å­˜
    loadDataFromDatabase();
    
    // 5. å¯åŠ¨UI
    startMainInterface();
    
    return 0;
}
```

### ğŸ“Š **æ•°æ®åº“è¿ç”¨è¯„ä¼°**:
- **åŠŸèƒ½å®Œæ•´åº¦**: 90% âœ…
- **æ•°æ®ä¸€è‡´æ€§**: 70% âš ï¸
- **ç”¨æˆ·ä½“éªŒ**: 95% âœ…
- **ä»£ç è´¨é‡**: 85% âœ…

ä½ çš„æ•°æ®åº“é›†æˆå·¥ä½œå·²ç»éå¸¸æˆåŠŸï¼Œä¸»è¦éœ€è¦è§£å†³æ•°æ®åŒæ­¥çš„é—®é¢˜ï¼Œç„¶åå°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç°ä»£åŒ–ä»“åº“ç®¡ç†ç³»ç»Ÿäº†ï¼ğŸ‰ 